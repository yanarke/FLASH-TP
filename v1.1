local tool = Instance.new("Tool")
tool.RequiresHandle = false
tool.Name = "Flash Teleport"
tool.Parent = game.Players.LocalPlayer.Backpack

local player = game.Players.LocalPlayer
local mouse = player:GetMouse()
local TweenService = game:GetService("TweenService")

local function tweenTo(part, targetCFrame, duration)
    local tweenInfo = TweenInfo.new(duration, Enum.EasingStyle.Sine, Enum.EasingDirection.Out)
    local tween = TweenService:Create(part, tweenInfo, {CFrame = targetCFrame})
    tween:Play()
    tween.Completed:Wait()
end

tool.Activated:Connect(function()
    if not mouse or not player.Character then return end

    local char = player.Character
    local hrp = char:FindFirstChild("HumanoidRootPart")
    if not hrp then return end

    local humanoid = char:FindFirstChildOfClass("Humanoid")
    local targetPos = mouse.Hit.p
    local startPos = hrp.Position

    for , part in ipairs(char:GetDescendants()) do
        if part:IsA("BasePart") then
            part.CanCollide = false
        end
    end

    local downPos = startPos - Vector3.new(0, 30, 0)
    tweenTo(hrp, CFrame.new(downPos), 0.1)

    local midPos = Vector3.new(targetPos.X, downPos.Y, targetPos.Z)
    tweenTo(hrp, CFrame.new(midPos), 0.3)

    local finalPos = targetPos + Vector3.new(0, 2.5, 0)
    tweenTo(hrp, CFrame.new(finalPos), 0.1)

    task.delay(0.2, function()
        for , part in ipairs(char:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = true
            end
        end
    end)
end)
